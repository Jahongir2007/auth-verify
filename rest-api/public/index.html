<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Auth-verify REST API Guide</title>

  <!-- Tailwind + DaisyUI (dark mode) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />

  <!-- Highlight.js (Monokai-Sublime) -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai-sublime.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <style>
    pre code { @apply rounded-lg p-4 overflow-x-auto; }
    .copy-btn { @apply btn btn-xs btn-ghost absolute top-2 right-2; }
  </style>
</head>

<body class="bg-base-100 text-base-content min-h-screen">

  <!-- Header -->
  <header class="bg-primary text-primary-content py-12">
    <div class="container mx-auto text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-3">Auth-verify REST API Guide</h1>
      <p class="text-lg opacity-90">
        Generate, send (Gmail / SMS) and verify OTPs ‚Äì examples in 6 languages
      </p>
    </div>
  </header>

  <div class="container mx-auto px-4 py-10">

    <!-- Intro -->
    <section class="prose prose-invert max-w-none mb-12">
      <h2>Overview</h2>
      <p>All requests go to <code class="bg-base-300 px-2 py-1 rounded">https://auth-verify-sy2y.onrender.com/</code> (replace with your production URL).</p>
      <ul class="list-disc pl-6">
        <li><strong>Generate:</strong> <code>POST /auth/otp/generate/{length}</code></li>
        <li><strong>SMS:</strong> <code>POST /auth/otp/send/sms/{to_phone}</code></li>
        <li><strong>Verify:</strong> <code>POST /auth/otp/verify/{to}</code></li>
      </ul>
      <div class="alert alert-info mt-4">
        <strong>Never</strong> hard-code credentials. Use environment variables (shown in each example).
      </div>
    </section>

    <!-- Language Tabs -->
    <div class="tabs tabs-boxed mb-6">
      <a class="tab tab-active" data-lang="python">Python</a>
      <a class="tab" data-lang="php">PHP</a>
      <a class="tab" data-lang="go">Go</a>
      <a class="tab" data-lang="java">Java</a>
      <a class="tab" data-lang="csharp">C#</a>
      <a class="tab" data-lang="ruby">Ruby</a>
    </div>

    <!-- Code Panels -->
    <div id="code-panels" class="space-y-8">

      <!-- ==================== PYTHON ==================== -->
      <div class="panel" data-lang="python">
        <h3 class="text-2xl font-semibold mb-3">Python (requests)</h3>
        <div class="relative">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-python">import os
import os
import requests
from dotenv import load_dotenv   # pip install python-dotenv

load_dotenv()

BASE_URL = os.getenv("OTP_BASE_URL", "https://auth-verify-sy2y.onrender.com/api")

# For SMS
SMS_PROVIDER = os.getenv("SMS_PROVIDER")        # twilio | nexmo | etc
SMS_KEY = os.getenv("SMS_KEY")
SMS_SECRET = os.getenv("SMS_SECRET")
SMS_SENDER = os.getenv("SMS_SENDER")


# ---------------------------------------------
# üîπ Generate OTP (REST: /auth/otp/generate/:len)
# ---------------------------------------------
def generate_otp(length=6):
    r = requests.post(f"{BASE_URL}/auth/otp/generate/{length}")
    r.raise_for_status()
    return r.json()

# -------------------------------------------------
# üîπ Send OTP via SMS (REST: /auth/otp/send/sms/:to)
# -------------------------------------------------
def send_otp_sms(phone, otp):
    payload = {
        "sender": {
            "provider": SMS_PROVIDER,
            "apiKey": SMS_KEY,
            "apiSecret": SMS_SECRET,
            "sender": SMS_SENDER,
            "text": f"Your OTP is {otp}"
        }
    }

    r = requests.post(f"{BASE_URL}/auth/otp/send/sms/{phone}", json=payload)
    r.raise_for_status()
    return r.json()


# ---------------------------------------------
# üîπ Verify OTP (REST: /auth/otp/verify/:to)
# ---------------------------------------------
def verify_otp(to, otp):
    r = requests.post(f"{BASE_URL}/auth/otp/verify/{to}", json={"otp": otp})
    r.raise_for_status()
    return r.json()


# ---------------------------------------------
# ‚ñ∂Ô∏è MAIN TEST
# ---------------------------------------------
if __name__ == "__main__":
    # Generate OTP
    data = generate_otp()
    otp = data.get("code")
    print("Generated OTP:", otp)

    # Send SMS
    # send_otp_sms("+998901234567", otp)

    # Verify OTP
    # print(verify_otp("+998901234567", otp))
</code></pre>
        </div>
      </div>

      <!-- ==================== PHP ==================== -->
      <div class="panel hidden" data-lang="php">
        <h3 class="text-2xl font-semibold mb-3">PHP (cURL)</h3>
        <div class="relative">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-php"><?php
$baseUrl = getenv('OTP_BASE_URL') ?: 'https://auth-verify-sy2y.onrender.com/api';
$smsProvider = getenv('SMS_PROVIDER');
$smsKey = getenv('SMS_KEY');
$smsSecret = getenv('SMS_SECRET');
$smsSender = getenv('SMS_SENDER');

function generateOtp($length = 6) {
    global $baseUrl;
    $ch = curl_init("$baseUrl/auth/otp/generate/$length");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $response = curl_exec($ch);
    curl_close($ch);
    return json_decode($response, true);
}

function sendOtpSms($phone, $otp) {
    global $baseUrl, $smsProvider, $smsKey, $smsSecret, $smsSender;
    $payload = [
        "sender" => [
            "provider" => $smsProvider,
            "apiKey" => $smsKey,
            "apiSecret" => $smsSecret,
            "sender" => $smsSender,
            "text" => "Your OTP is $otp"
        ]
    ];
    $ch = curl_init("$baseUrl/auth/otp/send/sms/$phone");
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $response = curl_exec($ch);
    curl_close($ch);
    return json_decode($response, true);
}

function verifyOtp($phone, $otp) {
    global $baseUrl;
    $payload = ["otp" => $otp];
    $ch = curl_init("$baseUrl/auth/otp/verify/$phone");
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $response = curl_exec($ch);
    curl_close($ch);
    return json_decode($response, true);
}

// -------- MAIN --------
$otpData = generateOtp();
$otp = $otpData['code'];
echo "Generated OTP: $otp\n";
// print_r(sendOtpSms("+998901234567", $otp));
// print_r(verifyOtp("+998901234567", $otp));

</code></pre>
        </div>
      </div>

      <!-- ==================== GO ==================== -->
      <div class="panel hidden" data-lang="go">
        <h3 class="text-2xl font-semibold mb-3">Go (net/http)</h3>
        <div class="relative">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-go">package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "io/ioutil"
    "net/http"
    "os"
)

var baseUrl = getEnv("OTP_BASE_URL", "https://auth-verify-sy2y.onrender.com/api")
var smsProvider = os.Getenv("SMS_PROVIDER")
var smsKey = os.Getenv("SMS_KEY")
var smsSecret = os.Getenv("SMS_SECRET")
var smsSender = os.Getenv("SMS_SENDER")

func getEnv(key, fallback string) string {
    if value := os.Getenv(key); value != "" {
        return value
    }
    return fallback
}

func generateOtp(length int) (map[string]interface{}, error) {
    resp, err := http.Post(fmt.Sprintf("%s/auth/otp/generate/%d", baseUrl, length), "application/json", nil)
    if err != nil {
        return nil, err
    }
    defer resp.Body.Close()
    var result map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&result)
    return result, nil
}

func sendOtpSms(phone, otp string) (map[string]interface{}, error) {
    payload := map[string]interface{}{
        "sender": map[string]string{
            "provider": smsProvider,
            "apiKey":   smsKey,
            "apiSecret": smsSecret,
            "sender":   smsSender,
            "text":     "Your OTP is " + otp,
        },
    }
    body, _ := json.Marshal(payload)
    resp, err := http.Post(fmt.Sprintf("%s/auth/otp/send/sms/%s", baseUrl, phone), "application/json", bytes.NewBuffer(body))
    if err != nil {
        return nil, err
    }
    defer resp.Body.Close()
    var result map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&result)
    return result, nil
}

func verifyOtp(phone, otp string) (map[string]interface{}, error) {
    payload := map[string]string{"otp": otp}
    body, _ := json.Marshal(payload)
    resp, err := http.Post(fmt.Sprintf("%s/auth/otp/verify/%s", baseUrl, phone), "application/json", bytes.NewBuffer(body))
    if err != nil {
        return nil, err
    }
    defer resp.Body.Close()
    var result map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&result)
    return result, nil
}

func main() {
    otpData, _ := generateOtp(6)
    otp := otpData["code"].(string)
    fmt.Println("Generated OTP:", otp)
    // sendOtpSms("+998901234567", otp)
    // verifyOtp("+998901234567", otp)
}
</code></pre>
        </div>
      </div>

      <!-- ==================== JAVA ==================== -->
      <div class="panel hidden" data-lang="java">
        <h3 class="text-2xl font-semibold mb-3">Java (HttpClient)</h3>
        <div class="relative">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-java">import java.net.URI;
import java.net.http.*;
import java.util.Map;
import com.fasterxml.jackson.databind.ObjectMapper;

public class OTPExample {
    private static final String BASE_URL = System.getenv().getOrDefault("OTP_BASE_URL", "https://auth-verify-sy2y.onrender.com/api");
    private static final String SMS_PROVIDER = System.getenv("SMS_PROVIDER");
    private static final String SMS_KEY = System.getenv("SMS_KEY");
    private static final String SMS_SECRET = System.getenv("SMS_SECRET");
    private static final String SMS_SENDER = System.getenv("SMS_SENDER");
    private static final ObjectMapper mapper = new ObjectMapper();

    public static Map<String,Object> generateOtp(int length) throws Exception {
        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(BASE_URL + "/auth/otp/generate/" + length))
            .POST(HttpRequest.BodyPublishers.noBody())
            .build();
        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
        return mapper.readValue(response.body(), Map.class);
    }

    public static Map<String,Object> sendOtpSms(String phone, String otp) throws Exception {
        HttpClient client = HttpClient.newHttpClient();
        Map<String,Object> payload = Map.of("sender", Map.of(
            "provider", SMS_PROVIDER,
            "apiKey", SMS_KEY,
            "apiSecret", SMS_SECRET,
            "sender", SMS_SENDER,
            "text", "Your OTP is " + otp
        ));
        String json = mapper.writeValueAsString(payload);
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(BASE_URL + "/auth/otp/send/sms/" + phone))
            .header("Content-Type", "application/json")
            .POST(HttpRequest.BodyPublishers.ofString(json))
            .build();
        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
        return mapper.readValue(response.body(), Map.class);
    }

    public static Map<String,Object> verifyOtp(String phone, String otp) throws Exception {
        HttpClient client = HttpClient.newHttpClient();
        String json = mapper.writeValueAsString(Map.of("otp", otp));
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(BASE_URL + "/auth/otp/verify/" + phone))
            .header("Content-Type", "application/json")
            .POST(HttpRequest.BodyPublishers.ofString(json))
            .build();
        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
        return mapper.readValue(response.body(), Map.class);
    }

    public static void main(String[] args) throws Exception {
        Map<String,Object> otpData = generateOtp(6);
        String otp = otpData.get("code").toString();
        System.out.println("Generated OTP: " + otp);
        // sendOtpSms("+998901234567", otp);
        // verifyOtp("+998901234567", otp);
    }
}

</code></pre>
        </div>
      </div>

      <!-- ==================== C# ==================== -->
      <div class="panel hidden" data-lang="csharp">
        <h3 class="text-2xl font-semibold mb-3">C# (.NET 6+)</h3>
        <div class="relative">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-csharp">using System;
using System.Net.Http;
using System.Text;
using System.Text.Json;
using System.Threading.Tasks;

class OTPExample {
    static string BASE_URL = Environment.GetEnvironmentVariable("OTP_BASE_URL") ?? "https://auth-verify-sy2y.onrender.com/api";
    static string SMS_PROVIDER = Environment.GetEnvironmentVariable("SMS_PROVIDER");
    static string SMS_KEY = Environment.GetEnvironmentVariable("SMS_KEY");
    static string SMS_SECRET = Environment.GetEnvironmentVariable("SMS_SECRET");
    static string SMS_SENDER = Environment.GetEnvironmentVariable("SMS_SENDER");

    static async Task<JsonElement> GenerateOtp(int length = 6) {
        using var client = new HttpClient();
        var response = await client.PostAsync($"{BASE_URL}/auth/otp/generate/{length}", null);
        response.EnsureSuccessStatusCode();
        var json = await response.Content.ReadAsStringAsync();
        return JsonSerializer.Deserialize<JsonElement>(json);
    }

    static async Task<JsonElement> SendOtpSms(string phone, string otp) {
        using var client = new HttpClient();
        var payload = new {
            sender = new {
                provider = SMS_PROVIDER,
                apiKey = SMS_KEY,
                apiSecret = SMS_SECRET,
                sender = SMS_SENDER,
                text = $"Your OTP is {otp}"
            }
        };
        var content = new StringContent(JsonSerializer.Serialize(payload), Encoding.UTF8, "application/json");
        var response = await client.PostAsync($"{BASE_URL}/auth/otp/send/sms/{phone}", content);
        response.EnsureSuccessStatusCode();
        var json = await response.Content.ReadAsStringAsync();
        return JsonSerializer.Deserialize<JsonElement>(json);
    }

    static async Task<JsonElement> VerifyOtp(string phone, string otp) {
        using var client = new HttpClient();
        var payload = new { otp = otp };
        var content = new StringContent(JsonSerializer.Serialize(payload), Encoding.UTF8, "application/json");
        var response = await client.PostAsync($"{BASE_URL}/auth/otp/verify/{phone}", content);
        response.EnsureSuccessStatusCode();
        var json = await response.Content.ReadAsStringAsync();
        return JsonSerializer.Deserialize<JsonElement>(json);
    }

    static async Task Main() {
        var otpData = await GenerateOtp();
        string otp = otpData.GetProperty("code").GetString();
        Console.WriteLine("Generated OTP: " + otp);
        // await SendOtpSms("+998901234567", otp);
        // await VerifyOtp("+998901234567", otp);
    }
}
</code></pre>
        </div>
      </div>

      <!-- ==================== RUBY ==================== -->
      <div class="panel hidden" data-lang="ruby">
        <h3 class="text-2xl font-semibold mb-3">Ruby (net/http)</h3>
        <div class="relative">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
          <pre><code class="language-ruby">require 'net/http'
require 'json'
require 'uri'

BASE_URL = ENV['OTP_BASE_URL'] || 'https://auth-verify-sy2y.onrender.com/api'
SMS_PROVIDER = ENV['SMS_PROVIDER']
SMS_KEY = ENV['SMS_KEY']
SMS_SECRET = ENV['SMS_SECRET']
SMS_SENDER = ENV['SMS_SENDER']

def generate_otp(length = 6)
  uri = URI("#{BASE_URL}/auth/otp/generate/#{length}")
  res = Net::HTTP.post(uri, ''.to_json, "Content-Type" => "application/json")
  JSON.parse(res.body)
end

def send_otp_sms(phone, otp)
  uri = URI("#{BASE_URL}/auth/otp/send/sms/#{phone}")
  payload = {
    sender: {
      provider: SMS_PROVIDER,
      apiKey: SMS_KEY,
      apiSecret: SMS_SECRET,
      sender: SMS_SENDER,
      text: "Your OTP is #{otp}"
    }
  }
  res = Net::HTTP.post(uri, payload.to_json, "Content-Type" => "application/json")
  JSON.parse(res.body)
end

def verify_otp(phone, otp)
  uri = URI("#{BASE_URL}/auth/otp/verify/#{phone}")
  payload = { otp: otp }
  res = Net::HTTP.post(uri, payload.to_json, "Content-Type" => "application/json")
  JSON.parse(res.body)
end

# ----- MAIN -----
otp_data = generate_otp()
otp = otp_data["code"]
puts "Generated OTP: #{otp}"
# send_otp_sms("+998901234567", otp)
# verify_otp("+998901234567", otp)

</code></pre>
        </div>
      </div>

    </div>
  </div>

  <!-- Footer -->
  <footer class="footer footer-center p-6 bg-base-300 text-base-content">
    <div>
      <p>Auth-verify REST API Guide <span class="font-bold">by <a class="nav-link" href="https://github.com/Jahongir2007">Jahongir Sobirov</a> &copy; 2025</span></p>
    </div>
  </footer>

  <!-- JS: tab switching + copy -->
  <script>
    // Tab handling
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('tab-active'));
        tab.classList.add('tab-active');

        const lang = tab.getAttribute('data-lang');
        document.querySelectorAll('.panel').forEach(p => {
          p.classList.toggle('hidden', p.getAttribute('data-lang') !== lang);
        });
      });
    });

    // Copy button
    function copyCode(btn) {
      const code = btn.parentElement.querySelector('pre code').innerText;
      navigator.clipboard.writeText(code).then(() => {
        const original = btn.innerHTML;
        btn.innerHTML = 'Copied!';
        setTimeout(() => btn.innerHTML = original, 1500);
      });
    }
  </script>
</body>
</html>
